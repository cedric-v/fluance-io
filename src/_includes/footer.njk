<footer class="bg-[#82153e] text-white mt-12 relative">
  <div class="max-w-6xl mx-auto px-4 py-10">
    <div class="space-y-8 border-b border-[#ffce2d]/20 pb-6 mb-6">
      <div class="flex flex-col md:flex-row justify-between items-start gap-8">
        <div class="space-y-3">
          <h3 class="text-lg font-bold">{% if locale == 'fr' %}Navigation{% else %}Navigation{% endif %}</h3>
          <ul class="space-y-2 text-sm text-[#ffce2d]/80">
            {% if locale == 'en' %}
            <li><a href="{{ '/en/' | relativeUrl }}" class="hover:text-[#ffce2d]">Home</a></li>
            <li><a href="{{ '/en/a-propos/philosophie/' | relativeUrl }}" class="hover:text-[#ffce2d]">About</a></li>
            <li><a href="{{ '/en/cours-en-ligne/21-jours-mouvement/' | relativeUrl }}" class="hover:text-[#ffce2d]">Online Courses</a></li>
            <li><a href="{{ '/en/presentiel/cours-hebdomadaires/' | relativeUrl }}" class="hover:text-[#ffce2d]">In-person</a></li>
            <li><a href="{{ '/en/accompagnements-individuels/entrepreneurs-independants/' | relativeUrl }}" class="hover:text-[#ffce2d]">1:1 Coaching</a></li>
            <li><a href="{{ '/en/contact/' | relativeUrl }}" class="hover:text-[#ffce2d]">Contact</a></li>
            {% else %}
            <li><a href="{{ '/' | relativeUrl }}" class="hover:text-[#ffce2d]">Accueil</a></li>
            <li><a href="{{ '/a-propos/philosophie/' | relativeUrl }}" class="hover:text-[#ffce2d]">A propos</a></li>
            <li><a href="{{ '/cours-en-ligne/21-jours-mouvement/' | relativeUrl }}" class="hover:text-[#ffce2d]">Cours en ligne</a></li>
            <li><a href="{{ '/presentiel/cours-hebdomadaires/' | relativeUrl }}" class="hover:text-[#ffce2d]">Pr√©sentiel</a></li>
            <li><a href="{{ '/accompagnements-individuels/entrepreneurs-independants/' | relativeUrl }}" class="hover:text-[#ffce2d]">Accompagnement 1:1</a></li>
            <li><a href="{{ '/contact/' | relativeUrl }}" class="hover:text-[#ffce2d]">Contact</a></li>
            {% endif %}
          </ul>
        </div>

        <div class="space-y-3 md:text-right">
          <h3 class="text-lg font-bold">{% if locale == 'fr' %}L√©gal{% else %}Legal{% endif %}</h3>
          <ul class="space-y-2 text-sm text-[#ffce2d]/80">
            <li><a href="{{ '/mentions-legales/' | relativeUrl }}" class="hover:text-[#ffce2d]">{% if locale == 'fr' %}Mentions l√©gales &amp; Confidentialit√©{% else %}Legal Notice &amp; Privacy{% endif %}</a></li>
            <li><a href="{{ '/cgv/' | relativeUrl }}" class="hover:text-[#ffce2d]">{% if locale == 'fr' %}Conditions g√©n√©rales de vente{% else %}Terms &amp; Conditions{% endif %}</a></li>
          </ul>
        </div>
      </div>

      <div class="space-y-4 text-center">
        <h3 class="text-lg font-bold">{% if locale == 'fr' %}Retrouvez Fluance sur les r√©seaux sociaux{% else %}Find Fluance on social media{% endif %}</h3>
        <div class="flex flex-wrap gap-4 items-center justify-center">
          <a href="https://www.youtube.com/@fluanceio" target="_blank" rel="noreferrer" aria-label="YouTube Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/youtube.png" alt="YouTube" class="w-12 h-12">
          </a>
          <a href="https://www.facebook.com/Fluanceio/" target="_blank" rel="noreferrer" aria-label="Facebook Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/facebook.png" alt="Facebook" class="w-12 h-12">
          </a>
          <a href="https://www.instagram.com/fluanceio/" target="_blank" rel="noreferrer" aria-label="Instagram Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/instagram.png" alt="Instagram" class="w-12 h-12">
          </a>
          <a href="https://ch.pinterest.com/fluanceio/" target="_blank" rel="noreferrer" aria-label="Pinterest Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/pinterest.png" alt="Pinterest" class="w-12 h-12">
          </a>
          <a href="https://x.com/fluanceio" target="_blank" rel="noreferrer" aria-label="X (Twitter) Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/x.png" alt="X" class="w-12 h-12">
          </a>
          <a href="https://www.linkedin.com/company/fluance-consulting/" target="_blank" rel="noreferrer" aria-label="LinkedIn Fluance" class="hover:opacity-80">
            <img src="https://optassets.ontraport.com/opt_assets/images/iconsets_v3/monochromatic/linkedin.png" alt="LinkedIn" class="w-12 h-12">
          </a>
        </div>
        <p class="text-sm text-[#ffce2d]/80">
          {% if locale == 'fr' %}Soci√©t√© Instants Zen S√†rl{% else %}Instants Zen S√†rl{% endif %}<br>
          {% if locale == 'fr' %}Tel :{% else %}Tel:{% endif %} <a href="tel:+33972133388" class="hover:text-[#ffce2d]">+33 (0)9 72 13 33 88</a><br>
          {% if locale == 'fr' %}Email :{% else %}Email:{% endif %} <a href="#" id="support-email-link" class="hover:text-[#ffce2d]"></a>
        </p>
        <script>
          // Protection anti-spam : construction dynamique de l'email
          (function() {
            const emailParts = ['support', 'fluance', 'io'];
            const email = emailParts[0] + '@' + emailParts[1] + '.' + emailParts[2];
            const emailLink = document.getElementById('support-email-link');
            if (emailLink) {
              emailLink.href = 'mailto:' + email;
              emailLink.textContent = email;
            }
          })();
        </script>
      </div>
    </div>

    <div class="text-center text-sm pt-2 text-[#ffce2d]/70">
      &copy; {{ "now" | date('yyyy') }} Fluance. {% if locale == 'fr' %}Tous droits r√©serv√©s.{% else %}All rights reserved.{% endif %}
    </div>
  </div>

  <!-- üëâ Bouton flottant "Aide ?" -->
  <style>
    #helpBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #82153e;
      color: white;
      border: none;
      border-radius: 50px;
      padding: 12px 20px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      font-weight: 600;
      transition: background-color 0.3s ease;
    }

    #helpBtn:hover {
      background-color: #6b1232;
    }

    #supportFormContainer {
      display: none;
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 320px;
      background: white;
      border: 2px solid #82153e;
      border-radius: 12px;
      padding: 20px;
      z-index: 9999;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    .form-group {
      margin-bottom: 15px;
    }

    #supportForm input,
    #supportForm textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-sizing: border-box;
      font-size: 16px;
      font-family: inherit;
    }

    #supportForm textarea {
      height: 150px;
      resize: vertical;
    }

    #supportForm button {
      background-color: #82153e;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      width: 100%;
      transition: background-color 0.3s ease;
    }

    #supportForm button:hover {
      background-color: #6b1232;
    }

    .message {
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 15px;
      word-wrap: break-word;
      white-space: normal;
      line-height: 1.4;
      font-size: 14px;
    }

    .success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    #supportFormContainer h3 {
      font-size: 18px;
      font-weight: normal;
      margin-bottom: 15px;
      color: #333;
    }
  </style>

  <!-- üëâ Formulaire de contact -->
  <div id="supportFormContainer">
    <!-- Titre du formulaire -->
    <h3>{% if locale == 'fr' %}Veuillez remplir ce formulaire et poser votre question.{% else %}Please fill out this form and ask your question.{% endif %}</h3>

    <div id="formSuccessMsg" class="message success" style="display: none;"></div>
    <div id="formErrorMsg" class="message error" style="display: none;"></div>

    <form id="supportForm" action="https://script.google.com/macros/s/AKfycbxifphmYM7trm1uo453PagbAjAhF64hvLXQ5ErQzjEjbY9stSdrOg1jHvVHrPE2Imlhmg/exec" method="POST">
      <input type="hidden" name="pageUrl" id="pageUrl">
      <div class="form-group">
        <input type="text" name="name" placeholder="{% if locale == 'fr' %}Pr√©nom{% else %}First name{% endif %}" required>
      </div>
      <div class="form-group">
        <input type="email" name="email" placeholder="{% if locale == 'fr' %}Email{% else %}Email{% endif %}" required>
      </div>
      <div class="form-group">
        <input type="text" name="subject" placeholder="{% if locale == 'fr' %}Sujet{% else %}Subject{% endif %}" required>
      </div>
      <div class="form-group">
        <textarea name="message" rows="6" placeholder="{% if locale == 'fr' %}Message{% else %}Message{% endif %}" required></textarea>
      </div>

      <!-- reCAPTCHA v2 -->
      <div class="g-recaptcha" data-sitekey="6Lc44DArAAAAADGQxzkPBZs4rR_jH5WVgWMD9Q-4"></div>

      <button type="submit">{% if locale == 'fr' %}Envoyer{% else %}Send{% endif %}</button>
    </form>
  </div>

  <!-- üëâ Bouton flottant -->
  <button id="helpBtn">{% if locale == 'fr' %}Aide ?{% else %}Help?{% endif %}</button>

  <!-- üëâ Scripts -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  <script>
    const form = document.getElementById('supportForm');
    const formContainer = document.getElementById('supportFormContainer');
    const successBox = document.getElementById('formSuccessMsg');
    const errorBox = document.getElementById('formErrorMsg');

    // Ajouter l'URL de la page au chargement
    if (document.getElementById('pageUrl')) {
      document.getElementById('pageUrl').value = window.location.href;
    }

    const helpBtn = document.getElementById('helpBtn');
    if (helpBtn) {
      helpBtn.addEventListener('click', () => {
        formContainer.style.display = (formContainer.style.display === 'block') ? 'none' : 'block';
        if (successBox) successBox.style.display = 'none';
        if (errorBox) errorBox.style.display = 'none';
      });
    }

    if (form) {
      form.addEventListener('submit', async e => {
        e.preventDefault();

        // R√©initialiser les messages
        if (successBox) {
          successBox.style.display = 'none';
        }
        if (errorBox) {
          errorBox.style.display = 'none';
        }

        try {
          const formData = new FormData(form);
          const response = await fetch(form.action, {
            method: 'POST',
            mode: 'no-cors',
            body: formData,
            headers: {
              'Accept': 'application/json'
            }
          });

          // Comme nous utilisons no-cors, nous ne pouvons pas lire la r√©ponse directement
          // Nous supposons que l'envoi a r√©ussi si nous n'avons pas d'erreur
          if (successBox) {
            successBox.textContent = "{% if locale == 'fr' %}‚úÖ Merci ! Votre message a √©t√© envoy√©.{% else %}‚úÖ Thank you! Your message has been sent.{% endif %}";
            successBox.style.display = "block";
          }
          form.reset();
          if (typeof grecaptcha !== 'undefined') {
            grecaptcha.reset();
          }
        } catch (error) {
          if (errorBox) {
            errorBox.textContent = "{% if locale == 'fr' %}‚ùå Une erreur est survenue lors de l'envoi.{% else %}‚ùå An error occurred while sending.{% endif %}";
            errorBox.style.display = "block";
          }
          console.error("Erreur :", error);
        }
      });
    }
  </script>
</footer>